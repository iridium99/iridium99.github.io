<!DOCTYPE html>
<html>
<head>
    <title>LDC RS Legends - Official Website</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon.png">
    <style>
        :root {
            --primary: #5865f2;
            --background: #1e1e2e;
            --card-bg: #2b2d3e;
            --text: #ffffff;
        }
        
        /* Gradient glow username style */
        .username-gradient {
            font-weight: bold;
            background: linear-gradient(90deg, var(--color1), var(--color2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 8px rgba(var(--glow-r), var(--glow-g), var(--glow-b), 0.6)) 
                    drop-shadow(0 0 4px rgba(var(--glow-r), var(--glow-g), var(--glow-b), 0.4));
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: var(--background);
            color: var(--text);
            margin: 0;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        /* Tab buttons styling - Using your UIverse button style */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }
        
        .tab {
            position: relative;
            padding: 10px 20px;
            border-radius: 7px;
            border: 1px solid rgb(61, 106, 255);
            font-size: 14px;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 2px;
            background: transparent;
            color: #fff;
            overflow: hidden;
            box-shadow: 0 0 0 0 transparent;
            -webkit-transition: all 0.2s ease-in;
            -moz-transition: all 0.2s ease-in;
            transition: all 0.2s ease-in;
            cursor: pointer;
            margin: 0 5px;
        }
        
        .tab.active {
            background: rgb(61, 106, 255);
        }
        
        .tab:hover {
            background: rgb(61, 106, 255);
            box-shadow: 0 0 30px 5px rgba(0, 142, 236, 0.815);
            -webkit-transition: all 0.2s ease-out;
            -moz-transition: all 0.2s ease-out;
            transition: all 0.2s ease-out;
        }
        
        .tab:hover::before {
            -webkit-animation: sh02 0.5s 0s linear;
            -moz-animation: sh02 0.5s 0s linear;
            animation: sh02 0.5s 0s linear;
        }
        
        .tab::before {
            content: '';
            display: block;
            width: 0px;
            height: 86%;
            position: absolute;
            top: 7%;
            left: 0%;
            opacity: 0;
            background: #fff;
            box-shadow: 0 0 50px 30px #fff;
            -webkit-transform: skewX(-20deg);
            -moz-transform: skewX(-20deg);
            -ms-transform: skewX(-20deg);
            -o-transform: skewX(-20deg);
            transform: skewX(-20deg);
        }
        
        @keyframes sh02 {
            from {
                opacity: 0;
                left: 0%;
            }
            
            50% {
                opacity: 1;
            }
            
            to {
                opacity: 0;
                left: 100%;
            }
        }
        
        .tab:active {
            box-shadow: 0 0 0 0 transparent;
            -webkit-transition: box-shadow 0.2s ease-in;
            -moz-transition: box-shadow 0.2s ease-in;
            transition: box-shadow 0.2s ease-in;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        select, input {
            padding: 10px;
            border: 2px solid var(--primary);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text);
            font-size: 14px;
        }
        
        .range-filters {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .range-filter {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .range-filter label {
            font-size: 14px;
            color: #a0a0a0;
        }
        
        .range-filter input {
            width: 80px;
        }
        
        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .player-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .player-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .player-rating {
            background: var(--primary);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 18px;
        }
        
        .player-name {
            font-size: 18px;
            font-weight: bold;
            margin: 0;
            flex-grow: 1;
            text-align: center;
        }
        
        .player-details {
            margin-top: 10px;
        }
        
        .player-detail {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        .detail-label {
            color: #a0a0a0;
        }
        
        .search-box {
            padding: 10px;
            width: 250px;
            border: 2px solid var(--primary);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text);
        }
        
        .player-position {
            background: #ff6b6b;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .player-nation {
            background: #4ecdc4;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        .player-image {
            width: 100%;
            border-radius: 12px;
            margin-bottom: 10px;
        }
        
        .help-content {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
        }
        
        .help-section {
            margin-bottom: 30px;
        }
        
        .help-section h3 {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 8px;
        }
        
        .command-list {
            list-style-type: none;
            padding: 0;
        }
        
        .command-list li {
            background: rgba(88, 101, 242, 0.1);
            margin-bottom: 10px;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }
        
        .command-name {
            font-weight: bold;
            color: var(--primary);
        }
        
        .feature-list {
            list-style-type: none;
            padding: 0;
        }
        
        .feature-list li {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }
        
        .feature-list li:before {
            content: "‚úì";
            color: var(--primary);
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        /* What's New specific styles */
        .updates-content {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .update-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary);
        }
        
        .update-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .update-title {
            font-size: 20px;
            color: var(--primary);
            margin: 0;
        }
        
        .update-date {
            color: #a0a0a0;
            font-size: 14px;
        }
        
        .update-badge {
            background: #ff6b6b;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .new-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .new-card {
            background: rgba(88, 101, 242, 0.1);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .new-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .card-image {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .card-name {
            font-weight: bold;
            margin: 5px 0;
        }
        
        .card-rating {
            color: var(--primary);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Welcome to LDC RS Legends</h1>
        <p>View all available players, commands, global stats, leaderboards</p>
    </div>

    <div class="tabs">
        <div class="tab" data-tab="whats-new">What's New</div>
        <div class="tab active" data-tab="players">Players</div>
        <div class="tab" data-tab="player-stats">Player Stats Leaderboard</div>
        <div class="tab" data-tab="user-stats">User Stats Leaderboard</div>
        <div class="tab" data-tab="league-standings">League Standings</div>
        <div class="tab" data-tab="help">Help & Commands</div>
    </div>

    <div class="tab-content" id="whats-new-tab">
        <p style="text-align:center;color:#a0a0a0;">Latest updates coming soon.</p>
    </div>

    <div class="tab-content active" id="players-tab">
        <div class="filters">
            <select id="sort-select">
                <option value="rating-desc">Rating: High to Low</option>
                <option value="rating-asc">Rating: Low to High</option>
                <option value="name-asc">Name: A to Z</option>
                <option value="name-desc">Name: Z to A</option>
                <option value="price-desc">Price: High to Low</option>
                <option value="price-asc">Price: Low to High</option>
            </select>
            
            <select id="position-filter">
                <!-- General categories first -->
                <option value="all">All Positions</option>
                <option value="GK">Goalkeeper</option>
                <option value="DEF">Defender</option>
                <option value="MID">Midfielder</option>
                <option value="ATT">Attacker</option>

                <!-- Specific positions after -->
                <option value="CB">Center Back</option>
                <option value="RB">Right Back</option>
                <option value="LB">Left Back</option>
                <option value="CDM">Defensive Mid</option>
                <option value="CM">Center Mid</option>
                <option value="CAM">Attacking Mid</option>
                <option value="RW">Right Wing</option>
                <option value="LW">Left Wing</option>
                <option value="ST">Striker</option>
            </select>
            
            <select id="rating-filter">
                <option value="all">All Ratings</option>
                <option value="90+">90+ OVR</option>
                <option value="85-89">85-89 OVR</option>
                <option value="80-84">80-84 OVR</option>
                <option value="75-79">75-79 OVR</option>
                <option value="70-74">70-74 OVR</option>
                <option value="60-69">60-69 OVR</option>
                <option value="40-59">40-59 OVR</option>
            </select>
            
            <input type="text" id="search-box" placeholder="Search players..." class="search-box">
        </div>

        <div class="range-filters">
            <div class="range-filter">
                <label for="min-price">Min Price:</label>
                <input type="number" id="min-price" placeholder="0" min="0">
            </div>
            <div class="range-filter">
                <label for="max-price">Max Price:</label>
                <input type="number" id="max-price" placeholder="Max">
            </div>
            <div class="range-filter">
                <label for="min-ovr">Min OVR:</label>
                <input type="number" id="min-ovr" placeholder="0" min="0" max="99">
            </div>
            <div class="range-filter">
                <label for="max-ovr">Max OVR:</label>
                <input type="number" id="max-ovr" placeholder="99" min="0" max="99">
            </div>
        </div>

        <div class="players-grid" id="players-container">
            <!-- Players will be loaded here -->
        </div>
    </div>

    <div class="tab-content" id="player-stats-tab">
        <div class="filters">
            <button id="load-player-stats-btn" style="padding:10px 20px;background:var(--primary);border:none;border-radius:8px;color:white;cursor:pointer;">Load Player Stats</button>
        </div>
        <div id="player-stats-container" style="max-width:1000px;margin:0 auto;"></div>
    </div>

    <div class="tab-content" id="user-stats-tab">
        <div class="filters">
            <button id="load-user-stats-btn" style="padding:10px 20px;background:var(--primary);border:none;border-radius:8px;color:white;cursor:pointer;">Load User Stats</button>
        </div>
        <div id="user-stats-container" style="max-width:1000px;margin:0 auto;"></div>
    </div>

    <div class="tab-content" id="league-standings-tab">
        <div class="filters">
            <button id="load-all-leagues-btn" style="padding:10px 20px;background:var(--primary);border:none;border-radius:8px;color:white;cursor:pointer;">Show All Leagues</button>
        </div>
        <div id="league-standings-container" style="max-width:1000px;margin:0 auto;"></div>
    </div>

    <div class="tab-content" id="help-tab">
        <div class="help-content">
            <div class="help-section">
                <h3>Website Features</h3>
                <ul class="feature-list">
                    <li><strong>Player Catalog:</strong> Browse all available players with detailed information including ratings, positions, and prices.</li>
                    <li><strong>Advanced Filtering:</strong> Filter players by position, rating range, and price range to find exactly what you're looking for.</li>
                    <li><strong>Search Functionality:</strong> Search for players by name.</li>
                    <li><strong>Sorting Options:</strong> Sort players by rating, name, or price in ascending or descending order.</li>
                    <li><strong>Responsive Design:</strong> The website works well on both desktop and mobile devices.</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Discord Commands</h3>
                <ul class="command-list">
                    <li><span class="command-name">/buyplayer [name]</span> - Purchase a player from the catalog</li>
                    <li><span class="command-name">/sellplayer [name]</span> - Sell a player from your collection</li>
                    <li><span class="command-name">/myteam</span> - View your current team lineup</li>
                    <li><span class="command-name">/balance</span> - Check your current coin balance</li>
                    <li><span class="command-name">/market</span> - View the transfer market (takes you to this website)</li>
                    <li><span class="command-name">/packs</span> - Open different types of packs</li>
                    <li><span class="command-name">/changeteamname</span> - Change your team's name</li>
                    <li><span class="command-name">/setlineup </span> - Change your team formation</li>
                    <li><span class="command-name">/duplicates</span> - View the duplicate cards in your collection</li>
                    <li><span class="command-name">/quickselldupes</span> - Sell all of your duplicate cards</li>
                    <li><span class="command-name">/ping</span> - Check the bot's response time</li>
                    <li><span class="command-name">/daily</span> - Claim your daily rewards</li>
                    <li><span class="command-name">/addplayer [name]</span> - Add a player to your team</li>
                    <li><span class="command-name">/removeplayer [name]</span> - Remove a player from your team</li>
                    <li><span class="command-name">/claim</span> - Claim a free player</li>
                    <li><span class="command-name">/collection</span> - View all of the players in your collection</li>
                    <li><span class="command-name">/friendly</span> - Play against another user in a friendly match</li>
                    <li><span class="command-name">/leaderboard</span> - View the leaderboard for: coins, collection</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Need More Help?</h3>
                <p>If you have any questions or need assistance, DM atrocity exhibition (the1n1ly)</p>
            </div>
        </div>
    </div>

    <script>
        const allPlayers = [
            {id:1,name:"Marcus Rashford",rating:85,position:"ST",nation:"England",buy_price:168750,sell_price:113062,img:"cards/rashford.png"},
            {id:2,name:"Bukayo Saka",rating:83,position:"RW",nation:"England",buy_price:106875,sell_price:71606,img:"cards/saka.png"},
            {id:3,name:"Phil Foden",rating:84,position:"CAM",nation:"England",buy_price:136875,sell_price:91706,img:"cards/foden.png"},
            {id:4,name:"Cristiano Ronaldo",rating:90,position:"ST",nation:"Portugal",buy_price:675000,sell_price:452250,img:"cards/ronaldo.png"},
            {id:5,name:"Lionel Messi",rating:91,position:"RW",nation:"Argentina",buy_price:990000,sell_price:663300,img:"cards/messi.png"},
            {id:6,name:"Kylian Mbapp√©",rating:88,position:"ST",nation:"France",buy_price:472500,sell_price:316575,img:"cards/mbappe.png"},
            {id:7,name:"Kevin De Bruyne",rating:87,position:"CAM",nation:"Belgium",buy_price:371250,sell_price:248512,img:"cards/debruyne.png"},
            {id:8,name:"Virgil van Dijk",rating:86,position:"CB",nation:"Netherlands",buy_price:270000,sell_price:180900,img:"cards/vandijk.png"},
            {id:9,name:"Neymar Jr",rating:85,position:"LW",nation:"Brazil",buy_price:168750,sell_price:113062,img:"cards/neymar.png"},
            {id:10,name:"shit guy",rating:55,position:"ST",nation:"Poland",buy_price:540,sell_price:384188,img:"cards/shit_guy.png"},
            {id:11,name:"atrocity exhibition creator",rating:99,position:"ST",nation:"England",buy_price:9999999,sell_price:1,img:"cards/atrocity_exhibition_creator.png"}
        ];

        const positionCategories = {
            'DEF': ['CB', 'RB', 'LB'],
            'MID': ['CDM', 'CM', 'CAM'],
            'ATT': ['RW', 'LW', 'ST']
        };

        let filteredPlayers = [...allPlayers];

        function displayPlayers(playersToDisplay) {
            const container = document.getElementById('players-container');
            container.innerHTML = '';

            if (playersToDisplay.length === 0) {
                container.innerHTML = '<p style="text-align:center;grid-column:1/-1;color:#a0a0a0;">No players found matching your filters.</p>';
                return;
            }

            playersToDisplay.forEach(player => {
                const card = document.createElement('div');
                card.className = 'player-card';
                card.innerHTML = `
                    <img src="${player.img}" alt="${player.name}" class="player-image">
                    <div class="player-header">
                        <div class="player-rating">‚≠ê ${player.rating}</div>
                        <h3 class="player-name">${player.name}</h3>
                    </div>
                    <div class="player-details">
                        <div class="player-detail">
                            <span class="detail-label">Position:</span>
                            <span class="player-position">${player.position}</span>
                        </div>
                        <div class="player-detail">
                            <span class="detail-label">Nation:</span>
                            <span class="player-nation">${player.nation}</span>
                        </div>
                        <div class="player-detail">
                            <span class="detail-label">Buy Price:</span>
                            <span>üí∞ ${player.buy_price.toLocaleString()} coins</span>
                        </div>
                        <div class="player-detail">
                            <span class="detail-label">Sell Price:</span>
                            <span>üíµ ${player.sell_price.toLocaleString()} coins</span>
                        </div>
                    </div>
                    <p style="margin-top:15px;text-align:center;font-size:12px;color:#a0a0a0;">
                        Use <code>/buyplayer ${player.name}</code> in Discord
                    </p>
                `;
                container.appendChild(card);
            });
        }

        function filterAndSortPlayers() {
            const sortValue = document.getElementById('sort-select').value;
            const positionFilter = document.getElementById('position-filter').value;
            const ratingFilter = document.getElementById('rating-filter').value;
            const searchTerm = document.getElementById('search-box').value.toLowerCase();
            
            const minPrice = document.getElementById('min-price').value ? parseInt(document.getElementById('min-price').value) : 0;
            const maxPrice = document.getElementById('max-price').value ? parseInt(document.getElementById('max-price').value) : Number.MAX_SAFE_INTEGER;
            const minOvr = document.getElementById('min-ovr').value ? parseInt(document.getElementById('min-ovr').value) : 0;
            const maxOvr = document.getElementById('max-ovr').value ? parseInt(document.getElementById('max-ovr').value) : 99;

            filteredPlayers = allPlayers.filter(player => {
                let matchesPosition = true;
                if(positionFilter !== 'all'){
                    if(['DEF','MID','ATT'].includes(positionFilter)){
                        matchesPosition = positionCategories[positionFilter].includes(player.position);
                    } else {
                        matchesPosition = player.position === positionFilter;
                    }
                }

                const matchesSearch = searchTerm === '' ||
                    player.name.toLowerCase().includes(searchTerm) ||
                    player.nation.toLowerCase().includes(searchTerm);

                let matchesRating = true;
                if(ratingFilter !== 'all'){
                    if(ratingFilter === '90+'){
                        matchesRating = player.rating >= 90;
                    } else {
                        const [min,max] = ratingFilter.split('-').map(Number);
                        matchesRating = player.rating >= min && player.rating <= max;
                    }
                }
                
                const matchesPriceRange = player.buy_price >= minPrice && player.buy_price <= maxPrice;
                const matchesOvrRange = player.rating >= minOvr && player.rating <= maxOvr;

                return matchesPosition && matchesSearch && matchesRating && matchesPriceRange && matchesOvrRange;
            });

            switch(sortValue){
                case'rating-desc': filteredPlayers.sort((a,b)=>b.rating-a.rating); break;
                case'rating-asc': filteredPlayers.sort((a,b)=>a.rating-b.rating); break;
                case'name-asc': filteredPlayers.sort((a,b)=>a.name.localeCompare(b.name)); break;
                case'name-desc': filteredPlayers.sort((a,b)=>b.name.localeCompare(a.name)); break;
                case'price-desc': filteredPlayers.sort((a,b)=>b.buy_price-a.buy_price); break;
                case'price-asc': filteredPlayers.sort((a,b)=>a.buy_price-b.buy_price); break;
            }

            displayPlayers(filteredPlayers);
        }

        // Add event listeners to all filter elements
        document.getElementById('sort-select').addEventListener('change', filterAndSortPlayers);
        document.getElementById('position-filter').addEventListener('change', filterAndSortPlayers);
        document.getElementById('rating-filter').addEventListener('change', filterAndSortPlayers);
        document.getElementById('search-box').addEventListener('input', filterAndSortPlayers);
        document.getElementById('min-price').addEventListener('input', filterAndSortPlayers);
        document.getElementById('max-price').addEventListener('input', filterAndSortPlayers);
        document.getElementById('min-ovr').addEventListener('input', filterAndSortPlayers);
        document.getElementById('max-ovr').addEventListener('input', filterAndSortPlayers);

        filterAndSortPlayers();

        function renderLeaderboardTable(rows) {
            if(!rows || rows.length === 0) {
                return '<p style="text-align:center;color:#a0a0a0;">No data available</p>';
            }
            let html = '<div style="background:var(--card-bg);padding:20px;border-radius:12px;overflow-x:auto;font-family:monospace;white-space:pre;">';
            html += 'Pos | User           | Team                          | P  | W  | D  | L  | GF | GA | GD  | Pts\n';
            html += '-'.repeat(95) + '\n';
            rows.forEach((team, idx) => {
                const pos = String(idx + 1).padStart(2, ' ');
                const userName = team.user || 'Unknown';
                const userPadded = userName.substring(0, 14).padEnd(14, ' ');
                const color = team.color || '';
                const teamName = (team.team_name || 'N/A').substring(0, 30).padEnd(30, ' ');
                const played = String(team.played || 0).padStart(2, ' ');
                const wins = String(team.wins || 0).padStart(2, ' ');
                const draws = String(team.draws || 0).padStart(2, ' ');
                const losses = String(team.losses || 0).padStart(2, ' ');
                const gf = String(team.gf || 0).padStart(2, ' ');
                const ga = String(team.ga || 0).padStart(2, ' ');
                const gd = String(team.gd || 0).padStart(3, ' ');
                const points = String(team.points || 0).padStart(3, ' ');
                
                const userDisplay = color ? `<span style="color:${color}">${userPadded}</span>` : userPadded;
                html += `${pos}  | ${userDisplay} | ${teamName} | ${played} | ${wins} | ${draws} | ${losses} | ${gf} | ${ga} | ${gd} | ${points}\n`;
            });
            html += '</div>';
            return html;
        }

        async function loadPlayerStats() {
            const container = document.getElementById('player-stats-container');
            container.innerHTML = '<p style="text-align:center;color:#a0a0a0;">Loading...</p>';
            try {
                const data = await fetch('/leaderboards/player_stats.json').then(r => r.json());
                
                // Create stat category tabs
                let html = '<div style="margin-bottom:20px;">';
                html += '<div style="display:flex;flex-wrap:wrap;gap:8px;justify-content:center;">';
                const categories = [
                    { key: 'topGoalScorers', label: 'üî• Top Goal Scorers' },
                    { key: 'topAssists', label: 'üéØ Top Assists' },
                    { key: 'mostAppearances', label: 'üë• Most Appearances' },
                    { key: 'mostMotms', label: '‚≠ê Most MOTMs' }
                ];
                
                categories.forEach((cat, idx) => {
                    html += `<button onclick="showPlayerStatCategory('${cat.key}')" style="padding:8px 12px;background:var(--primary);border:none;border-radius:6px;color:white;cursor:pointer;font-size:12px;">${cat.label}</button>`;
                });
                html += '</div></div>';
                
                // Store data globally for category switching
                window.playerStatsData = data;
                window.playerStatsCategories = categories;
                
                // Show first category by default
                html += `<div id="stat-category-display"></div>`;
                container.innerHTML = html;
                
                // Display first category
                showPlayerStatCategory('topGoalScorers');
            } catch (e) {
                container.innerHTML = `<p style="color:red;">Error loading player stats: ${e.message}</p>`;
            }
        }

        function showPlayerStatCategory(category) {
            const data = window.playerStatsData[category] || [];
            const display = document.getElementById('stat-category-display');
            
            if(!data || data.length === 0) {
                display.innerHTML = '<p style="text-align:center;color:#a0a0a0;">No data available</p>';
                return;
            }
            
            let html = '<div style="max-width:900px;margin:0 auto;">';
            data.slice(0, 20).forEach((item, idx) => {
                let stat;
                if (item.stat !== undefined) {
                    const decimals = item.decimals !== undefined ? item.decimals : 2;
                    stat = typeof item.stat === 'number' ? item.stat.toFixed(decimals) : item.stat;
                } else {
                    stat = item.value;
                }
                const unit = item.unit || '';
                html += `
                    <div style="background:var(--card-bg);padding:12px;margin-bottom:10px;border-radius:8px;display:flex;justify-content:space-between;align-items:center;border-left:4px solid var(--primary);">
                        <div style="flex:1;">
                            <span style="color:var(--primary);font-weight:bold;margin-right:8px;">#${idx + 1}</span>
                            <span style="font-weight:bold;">${item.playerName}</span>
                            <span style="color:#a0a0a0;font-size:12px;margin-left:10px;">(${item.teamName})</span>
                        </div>
                        <div style="font-weight:bold;color:var(--primary);font-size:16px;">${stat} ${unit}</div>
                    </div>
                `;
            });
            html += '</div>';
            display.innerHTML = html;
        }

        async function loadUserStats() {
            const container = document.getElementById('user-stats-container');
            container.innerHTML = '<p style="text-align:center;color:#a0a0a0;">Loading...</p>';
            try {
                const data = await fetch('/leaderboards/user_stats.json').then(r => r.json());
                
                // Create stat category tabs
                let html = '<div style="margin-bottom:20px;">';
                html += '<div style="display:flex;flex-wrap:wrap;gap:8px;justify-content:center;">';
                const categories = [
                    { key: 'richestUsers', label: 'üí∞ Richest Users' },
                    { key: 'biggestCollection', label: 'üé¥ Biggest Collection' },
                    { key: 'mostValuableTeam', label: 'üíé Most Valuable Team' },
                    { key: 'highestAvgRating', label: '‚≠ê Highest Avg Rating' },
                    { key: 'teamGoalsScored', label: '‚öΩ Team Goals Scored' },
                    { key: 'highestWinrate', label: 'üèÜ Highest Winrate (min 10)' }
                ];
                
                categories.forEach((cat, idx) => {
                    html += `<button onclick="showUserStatCategory('${cat.key}')" style="padding:8px 12px;background:var(--primary);border:none;border-radius:6px;color:white;cursor:pointer;font-size:12px;">${cat.label}</button>`;
                });
                html += '</div></div>';
                
                // Store data globally for category switching
                window.userStatsData = data;
                window.userStatsCategories = categories;
                
                // Show first category by default
                html += `<div id="user-stat-category-display"></div>`;
                container.innerHTML = html;
                
                // Display first category
                showUserStatCategory('richestUsers');
            } catch (e) {
                container.innerHTML = `<p style="color:red;">Error loading user stats: ${e.message}</p>`;
            }
        }

        function showUserStatCategory(category) {
            const data = window.userStatsData[category] || [];
            const display = document.getElementById('user-stat-category-display');
            
            if(!data || data.length === 0) {
                display.innerHTML = '<p style="text-align:center;color:#a0a0a0;">No data available</p>';
                return;
            }
            
            let html = '<div style="max-width:900px;margin:0 auto;">';
            data.slice(0, 20).forEach((item, idx) => {
                const stat = item.stat !== undefined ? (typeof item.stat === 'number' && item.stat % 1 !== 0 ? item.stat.toFixed(2) : item.stat) : item.value;
                const unit = item.unit || '';
                const color1 = item.color || '';
                const color2 = item.color2 || color1;  // If no second color, use first color (solid)
                
                // Create gradient style
                let usernameStyle = 'font-weight:bold;';
                let usernameClass = '';
                
                if (color1) {
                    // Parse RGB from hex for glow effect
                    const r1 = parseInt(color1.slice(1, 3), 16);
                    const g1 = parseInt(color1.slice(3, 5), 16);
                    const b1 = parseInt(color1.slice(5, 7), 16);
                    
                    const r2 = parseInt((color2 || color1).slice(1, 3), 16);
                    const g2 = parseInt((color2 || color1).slice(3, 5), 16);
                    const b2 = parseInt((color2 || color1).slice(5, 7), 16);
                    
                    // Average glow color
                    const glowR = Math.round((r1 + r2) / 2);
                    const glowG = Math.round((g1 + g2) / 2);
                    const glowB = Math.round((b1 + b2) / 2);
                    
                    usernameStyle = `
                        font-weight:bold;
                        background: linear-gradient(90deg, ${color1}, ${color2 || color1});
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                        background-clip: text;
                        filter: drop-shadow(0 0 8px rgba(${glowR}, ${glowG}, ${glowB}, 0.6)) 
                                drop-shadow(0 0 4px rgba(${glowR}, ${glowG}, ${glowB}, 0.4));
                    `;
                }
                
                html += `
                    <div style="background:var(--card-bg);padding:12px;margin-bottom:10px;border-radius:8px;display:flex;justify-content:space-between;align-items:center;border-left:4px solid var(--primary);">
                        <div style="flex:1;">
                            <span style="color:var(--primary);font-weight:bold;margin-right:8px;">#${idx + 1}</span>
                            <span style="${usernameStyle}">${item.username || item.teamName}</span>
                            <span style="color:#a0a0a0;font-size:12px;margin-left:10px;">${item.teamName ? '(' + item.teamName + ')' : ''}</span>
                        </div>
                        <div style="font-weight:bold;color:var(--primary);font-size:16px;">${stat} ${unit}</div>
                    </div>
                `;
            });
            html += '</div>';
            display.innerHTML = html;
        }

        async function loadAllLeagueStandings() {
            const container = document.getElementById('league-standings-container');
            container.innerHTML = '<p style="text-align:center;color:#a0a0a0;">Loading all leagues...</p>';
            try {
                // Fetch list of league files by trying common league IDs
                const leagueIds = [];
                for (let i = 1; i <= 50; i++) {
                    try {
                        const response = await fetch(`/leaderboards/league_${i}.json`);
                        if (response.ok) {
                            leagueIds.push(i);
                        }
                    } catch (e) {
                        // continue
                    }
                }
                
                if (leagueIds.length === 0) {
                    container.innerHTML = '<p style="text-align:center;color:#a0a0a0;">No league standings available yet.</p>';
                    return;
                }
                
                let html = '';
                for (const leagueId of leagueIds) {
                    try {
                        const data = await fetch(`/leaderboards/league_${leagueId}.json`).then(r => r.json());
                        const viewDetailsLink = `<a href="leagues/league.html?id=${leagueId}" style="margin-left:15px;color:#5865f2;text-decoration:none;font-weight:bold;">View Full Details ‚Üí</a>`;
                        html += `<div style="margin-bottom:30px;"><h3 style="margin:0 0 15px;color:var(--primary);font-size:18px;display:flex;align-items:center;justify-content:space-between;"><div>League ${leagueId}</div><div style="font-size:0.7em;margin-right:10px;">${viewDetailsLink}</div></h3>${renderLeaderboardTable(data.standings || data)}</div>`;
                    } catch (e) {
                        // skip unreadable league
                    }
                }
                
                if (html === '') {
                    container.innerHTML = '<p style="text-align:center;color:#a0a0a0;">No league data available.</p>';
                } else {
                    container.innerHTML = html;
                }
            } catch (e) {
                container.innerHTML = `<p style="color:red;">Error loading leagues: ${e.message}</p>`;
            }
        }

        document.getElementById('load-player-stats-btn').addEventListener('click', loadPlayerStats);
        document.getElementById('load-user-stats-btn').addEventListener('click', loadUserStats);
        document.getElementById('load-all-leagues-btn').addEventListener('click', loadAllLeagueStandings);

        let playerStatsLoaded = false;
        let userStatsLoaded = false;
        let leaguesLoaded = false;

        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                const tabName = tab.getAttribute('data-tab');
                document.getElementById(`${tabName}-tab`).classList.add('active');
                if(tabName === 'player-stats' && !playerStatsLoaded) {
                    playerStatsLoaded = true;
                    loadPlayerStats();
                }
                if(tabName === 'user-stats' && !userStatsLoaded) {
                    userStatsLoaded = true;
                    loadUserStats();
                }
                if(tabName === 'league-standings' && !leaguesLoaded) {
                    leaguesLoaded = true;
                    loadAllLeagueStandings();
                }
            });
        });
    </script>
</body>
</html>
